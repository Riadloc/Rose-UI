!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("more-select",[],t):"object"==typeof exports?exports["more-select"]=t():e["more-select"]=t()}(window,function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=7)}([function(e,t,n){},function(e,t,n){},function(e,t,n){(function(t){
/*!
{
  "copywrite": "Copyright (c) 2018-present",
  "date": "2019-01-21T12:39:36.944Z",
  "describe": "",
  "description": "Vue directive to react on clicks outside an element.",
  "file": "v-click-outside-x.min.js",
  "hash": "ef8b7b3c24168423686e",
  "license": "MIT",
  "version": "3.7.1"
}
*/
(function(){"use strict";"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t||Function("return this")()})(),e.exports=function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){s(e,t,n[t])})}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0}),t.install=function(e){e.directive("click-outside",f)},t.directive=void 0;var r=Object.create(null),l=Object.create(null),a=[r,l],c=function(e,t,n){var o=n.target,i=function(t){var i=t.el;if(i!==o&&!i.contains(o)){var s=t.binding;s.modifiers.stop&&n.stopPropagation(),s.modifiers.prevent&&n.preventDefault(),s.value.call(e,n)}};Object.keys(t).forEach(function(e){return t[e].forEach(i)})},u=function(e){c(this,r,e)},p=function(e){c(this,l,e)},d=function(e){return e?u:p},f=Object.defineProperties({},{$_captureInstances:{value:r},$_nonCaptureInstances:{value:l},$_onCaptureEvent:{value:u},$_onNonCaptureEvent:{value:p},bind:{value:function(e,t){if("function"!=typeof t.value)throw new TypeError("Binding value must be a function.");var n=t.arg||"click",s=i({},t,{arg:n,modifiers:i({},{capture:!1,prevent:!1,stop:!1},t.modifiers)}),a=s.modifiers.capture,c=a?r:l;Array.isArray(c[n])||(c[n]=[]),1===c[n].push({el:e,binding:s})&&"object"===("undefined"==typeof document?"undefined":o(document))&&document&&document.addEventListener(n,d(a),a)}},unbind:{value:function(e){var t=function(t){return t.el!==e};a.forEach(function(e){var n=Object.keys(e);if(n.length){var i=e===r;n.forEach(function(n){var s=e[n].filter(t);s.length?e[n]=s:("object"===("undefined"==typeof document?"undefined":o(document))&&document&&document.removeEventListener(n,d(i),i),delete e[n])})}})}},version:{enumerable:!0,value:"3.7.1"}});t.directive=f}])}).call(this,n(4))},function(e,t,n){},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";var o=n(0);n.n(o).a},function(e,t,n){"use strict";var o=n(1);n.n(o).a},function(e,t,n){"use strict";n.r(t);n(3);var o=function(){var e,t=this,n=t.$createElement,o=t._self._c||n;return o("div",{directives:[{name:"click-outside",rawName:"v-click-outside.capture",value:t.onClickOutside,expression:"onClickOutside",modifiers:{capture:!0}},{name:"click-outside",rawName:"v-click-outside:mousedown.capture",value:t.onClickOutside,expression:"onClickOutside",arg:"mousedown",modifiers:{capture:!0}}],class:t.classes},[o("div",{ref:"selection",class:t.prefixCls+"-selection",on:{click:t.onInputClick,mouseenter:function(e){t.hasMouseHoverHead=!0},mouseleave:function(e){t.hasMouseHoverHead=!1}}},[t.multiple?o("div",[t._l(t.values,function(e,n){return o("Tag",{key:e.value,class:t.prefixCls+"-tag",attrs:{label:e.label},on:{"on-close":function(){return t.removeTag(n)}}})}),t._v(" "),t.filterable?o("input",{directives:[{name:"model",rawName:"v-model",value:t.query,expression:"query"}],ref:"input",class:t.prefixCls+"-input",style:t.inputStyle,attrs:{readonly:!t.filterable,autocomplete:t.autocomplete,spellcheck:"false",type:"text",placeholder:t.values.length?"":t.placeholder},domProps:{value:t.query},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"delete",[8,46],e.key,["Backspace","Delete","Del"])?null:t.removeTag()},input:function(e){e.target.composing||(t.query=e.target.value)}}}):t.values.length?t._e():o("span",{class:t.prefixCls+"-placeholder"},[t._v(t._s(t.placeholder))])],2):o("div",[o("input",{directives:[{name:"model",rawName:"v-model",value:t.query,expression:"query"}],class:t.prefixCls+"-input",attrs:{readonly:!t.filterable||t.disabled,autocomplete:t.autocomplete,spellcheck:"false",type:"text",placeholder:t.placeholder},domProps:{value:t.query},on:{input:function(e){e.target.composing||(t.query=e.target.value)}}})]),t._v(" "),t.canBeCleared?o("Icon",{class:t.prefixCls+"-arrow",attrs:{type:"roundclosefill"},nativeOn:{click:function(e){return e.stopPropagation(),t.clearSelect(e)}}}):o("Icon",{class:t.prefixCls+"-arrow",attrs:{type:"unfold"}})],1),t._v(" "),o("transition",{attrs:{name:"trainsition-drop"}},[o("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],class:t.prefixCls+"-dropdown "+t.popperClass,style:t.dropStyle},[o("ul",{directives:[{name:"show",rawName:"v-show",value:!(t.selectOptions.length||t.allowCreate&&t.query),expression:"!(selectOptions.length || (allowCreate && query))"}],class:t.prefixCls+"-not-found"},[o("li",[t._v(t._s(t.notFoundText))])]),t._v(" "),o("ul",{class:t.prefixCls+"-dropdown-list"},[o("li",{directives:[{name:"show",rawName:"v-show",value:t.allowCreate&&t.query,expression:"allowCreate && query"}],key:"create",class:[t.prefixCls+"-item",(e={},e[t.prefixCls+"-item-selected"]=t.createValues.includes(t.query),e)],on:{click:t.onCreateItemClick}},[t._v("\n          "+t._s(t.query)+"\n        ")]),t._v(" "),o("functional-options",{attrs:{options:t.selectOptions,"slot-update-hook":t.updateSlotOptions,"slot-options":t.slotOptions}}),t._v(" "),o("li",{directives:[{name:"show",rawName:"v-show",value:t.showLoadMoreTip,expression:"showLoadMoreTip"}],key:"more",class:t.prefixCls+"-more "+t.loadMoreClass,on:{click:t.onLoadMoreClick}},[t._t("loadmore",[o("Spin",{class:t.prefixCls+"-spin"}),t._v(" "),o("span",[t._v("正在加载...")])])],2)],1)])])],1)};o._withStripped=!0;var i=n(2);const s=()=>[];function r(e,t,n,o,i,s,r,l){var a,c="function"==typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=n,c._compiled=!0),o&&(c.functional=!0),s&&(c._scopeId="data-v-"+s),r?(a=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),i&&i.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(r)},c._ssrRegister=a):i&&(a=l?function(){i.call(this,this.$root.$options.shadowRoot)}:i),a)if(c.functional){c._injectStyles=a;var u=c.render;c.render=function(e,t){return a.call(t),u(e,t)}}else{var p=c.beforeCreate;c.beforeCreate=p?[].concat(p,a):[a]}return{exports:e,options:c}}var l=r({functional:!0,props:{options:{type:Array,default:s},slotOptions:{type:Array,default:s},slotUpdateHook:{type:Function,default:()=>{}}},render(e,t){let n=t.props,o=t.parent;return n.slotOptions!==o.$slots.default&&n.slotUpdateHook(o),n.options}},void 0,void 0,!1,null,null,null);l.options.__file="src/components/select/functional-options.vue";var a=l.exports,c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"more-tag"},[n("span",{staticClass:"more-tag-text"},[e._v(e._s(e.label))]),e._v(" "),n("Icon",{staticClass:"close",attrs:{type:"close",size:"13"},nativeOn:{click:function(t){return t.stopPropagation(),e.close(t)}}})],1)};c._withStripped=!0;var u=function(){var e=this.$createElement;return(this._self._c||e)("i",{class:this.classes,style:this.styles})};u._withStripped=!0;var p=r({name:"Icon",props:{type:{type:String,required:!0},size:{type:[String,Number],default:"14"},color:{type:String}},computed:{classes(){return["iconfont",{["".concat("icon","-").concat(this.type)]:!0}]},styles(){let e={};return this.size&&(e["font-size"]="".concat(this.size,"px")),this.color&&(e.color=this.color),e}}},u,[],!1,null,null,null);p.options.__file="src/components/icon/icon.vue";var d=p.exports,f={components:{Icon:d},props:{label:{type:String,default:""}},methods:{close(e){this.$emit("on-close",e)}}},h=(n(5),r(f,c,[],!1,null,null,null));h.options.__file="src/components/tag/tag.vue";var m=h.exports,v=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"more-spin"},[t("svg",{staticClass:"more-spin-circular",attrs:{viewBox:"25 25 50 50"}},[t("circle",{staticClass:"more-spin-path",attrs:{cx:"50",cy:"50",r:"20",fill:"none","stroke-width":"5","stroke-miterlimit":"10"}})])])};v._withStripped=!0;var y={},b=(n(6),r(y,v,[],!1,null,null,null));b.options.__file="src/components/spin/spin.vue";var g=b.exports;var O={methods:{dispatch(e,t,n){let o=this.$parent||this.$root,i=o.$options.name;for(;o&&(!i||i!==e);)(o=o.$parent)&&(i=o.$options.name);o&&o.$emit.apply(o,[t].concat(n))},broadcast(e,t,n){(function e(t,n,o){this.$children.forEach(i=>{i.$options.name===t?i.$emit.apply(i,[n].concat(o)):e.apply(i,[t,n].concat([o]))})}).call(this,e,t,n)}}};const _=/([:\-_]+(.))/g,w=/^moz([A-Z])/;function x(e,t){if(!e||!t)return null;"float"===(t=t.replace(_,function(e,t,n,o){return o?n.toUpperCase():n}).replace(w,"Moz$1"))&&(t="cssFloat");try{const n=document.defaultView.getComputedStyle(e,"");return e.style[t]||n?n[t]:null}catch(n){return e.style[t]}}function C(e){return e.toString()[0].toUpperCase()+e.toString().slice(1)}function S(e){return{"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regExp","[object Undefined]":"undefined","[object Null]":"null","[object Object]":"object"}[Object.prototype.toString.call(e)]}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){k(e,t,n[t])})}return e}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const $="more-select",E=[{componentName:"FormItem",event:"on-form-change"},{componentName:"ElFormItem",event:"el.form.change"}],L=e=>{if(e.componentOptions.propsData.label)return e.componentOptions.propsData.label;const t=(e.componentOptions.children||[]).reduce((e,t)=>e+(t.text||""),""),n=((e,t)=>{return t.split(".").reduce((e,t)=>e&&e[t]||null,e)})(e,"data.domProps.innerHTML");return(t||("string"===S(n)?n:"")).trim()};var M=r({name:"MoreSelect",directives:{clickOutside:i.directive},components:{FunctionalOptions:a,Tag:m,Icon:d,Spin:g},mixins:[O],props:{value:{type:[String,Number,Array],default:""},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},allowCreate:{type:Boolean,default:!1},autocomplete:{type:Boolean,default:!1},placeholder:{type:String,default:"请选择"},notFoundText:{type:String,default:"无匹配数据"},popperClass:{type:String,default:""},filterable:{type:Boolean,default:!1},size:{validator:e=>["small","large","default"].includes(e),default:"default"},events:{type:Array,default:function(){return[]}},loadMore:{type:[Number,Boolean]},loadMoreClass:{type:String,default:""}},data(){return{isFocused:!1,visible:!1,querying:!1,hasMouseHoverHead:!1,prefixCls:$,slotOptions:this.$slots.default,query:"",values:[],createValues:[],multipleList:[],selectedLabel:"",dropStyle:{top:"32px"},inputLength:20,limitRange:0}},computed:{classes(){return["".concat($),{["".concat($,"-focus")]:this.isFocused,["".concat($,"-visible")]:this.visible,["".concat($,"-disabled")]:this.disabled,["".concat($,"-multiple")]:this.multiple,["".concat($,"-").concat(this.size)]:!!this.size}]},optionLimit(){return"number"===S(this.loadMore)?this.loadMore:50},selectOptions(){const e=this.query;let t;if(e!==this.selectedLabel&&e)t=this.findOptions(e);else{const e=this.slotOptions||[];t=this.loadMore?e.slice(0,this.limitRange-1):e}return t.map(e=>this.processOption(e,this.value))},fullEvents(){return this.events.concat(E).filter((e,t,n)=>{let o=e.componentName;return t===n.findIndex(e=>e.componentName===o)})},shouldMapping(){return JSON.stringify(this.value)!==JSON.stringify(this.multiple?this.values.map(e=>{return e.value}):this.query)},showLoadMoreTip(){return this.loadMore&&this.limitRange<(this.slotOptions||[]).length&&!this.querying},canBeCleared(){return this.clearable&&this.query&&this.hasMouseHoverHead&&!this.multiple&&!this.disabled},inputStyle(){let e={};return this.multiple&&void 0!==this.values[0]&&(e.width="".concat(this.inputLength,"px")),e}},watch:{value(e){this.shouldMapping&&(this.mapInitValue(e),this.dispatchEvents(e))},query(e,t){if(e!==this.selectedLabel&&e){const t=x(this.$refs.selection,"fontSize");this.inputLength=e.length*parseInt(t)+20,this.visible=!0,this.querying=!0}else this.querying=!1,this.inputLength=20;this.allowCreate&&e!==this.selectedLabel&&t===this.selectedLabel&&!this.multiple&&this.createValues.pop(),this.$emit("on-query-change",e),this.refreshDropTop()},values(e){this.refreshDropTop();const t=e.map(e=>{return e.value});JSON.stringify(t)!==JSON.stringify(this.value)&&(this.$emit("on-change",t),this.$emit("input",t),this.dispatchEvents(t))},visible(e){this.$emit("on-open-change",e)},isFocused(){this.automaticDropdown&&!this.visible&&(this.visible=!0)}},mounted(){this.loadMore&&(this.fn=function(e,t){let n,o=0;return function(){const i=+new Date,s=t-(i-o);s<=0?(n&&(clearTimeout(n),n=null),o=i,e()):(clearTimeout(n),n=setTimeout(()=>{o=i,n=null,e()},s))}}(this.refresh,100),this.scrollEl=document.querySelector(".".concat($,"-dropdown")),this.bindLoadEvent(),this.limitRange=this.optionLimit),this.$on("on-select-selected",this.onOptionClick),this.mapInitValue(this.value)},beforeDestroy(){this.fn&&this.offLoadEvent()},methods:{refreshDropTop(){this.$nextTick(()=>{const e=x(this.$refs.selection,"height");e!==this.dropStyle.top&&(this.dropStyle.top=e)})},mapInitValue(e){if(null!=e)if(this.multiple)"string"===S(e)&&(e=[e].filter(Boolean)),this.values=e.map(e=>{return{value:e,label:(this.getOptionData(e)||{}).label}});else{"array"===S(e)&&(t="value",o="Array",n=C(n="String"),o=C(o),console.error("[more-select warn]: Invalid prop: type check failed for prop ".concat(t,". Expected ").concat(n,", got ").concat(o,".")));const i=(this.getOptionData(e)||{}).label;this.query=i,this.selectedLabel=i}var t,n,o},bindLoadEvent(){this.scrollEl.addEventListener("scroll",this.fn)},offLoadEvent(){this.scrollEl.removeEventListener("scroll",this.fn)},dispatchEvents(e){this.fullEvents.forEach(t=>{let n=t.componentName,o=t.event;this.dispatch(n,o,e)})},onInputClick(){this.disabled||(this.multiple&&this.filterable&&this.$refs.input.focus(),this.isFocused=!0,this.visible=!this.visible)},onOptionClick(e){let t=e.value,n=e.label,o=e.created,i=void 0!==o&&o;if(this.multiple){const e=this.values.findIndex(e=>e.value===t);~e?this.values.splice(e,1):this.values.push({value:t,label:n}),this.query=""}else this.query=t,this.selectedLabel=t,this.visible=!1,this.$emit("input",t),this.$emit("on-change",t);if(i)if(this.multiple){const e=this.createValues.findIndex(e=>e===t);~e?this.createValues.splice(e,1):this.createValues.push(t)}else this.createValues=[t]},onClickOutside(e){if(this.visible){if("mousedown"===e.type)return void e.preventDefault();e.preventDefault(),this.isFocused=!0,this.visible=!1}else this.isFocused=!1;this.query!==this.selectedLabel&&(this.query=this.selectedLabel)},onCreateItemClick(){const e=this.query;this.onOptionClick({value:e,label:e,created:!0})},removeTag(e){if(e=e||this.values.length-1,!this.disabled&&!this.query&&~e){const t=this.values[e].value;if(this.values.splice(e,1),this.allowCreate){const e=this.createValues.findIndex(e=>e===t);~e&&this.createValues.splice(e,1)}}},refresh(){const e=this.scrollEl.getBoundingClientRect().height,t=this.scrollEl;t.scrollTop+10+e>=t.scrollHeight&&setTimeout(()=>{this.onLoadMoreClick()},1e3)},updateSlotOptions(e){this.slotOptions=this.$slots.default,this.shouldMapping&&this.mapInitValue(this.value)},onLoadMoreClick(){this.limitRange=this.limitRange+this.optionLimit},clearSelect(){this.query="",this.selectedLabel="",this.$emit("input",""),this.$emit("on-clear")},getOptionData(e){const t=this.slotOptions&&this.slotOptions.find(t=>{return t.componentOptions.propsData.value===e});if(!t)return null;const n=L(t);return{value:e,label:n}},findOptions(e){return e=(e||"").trim(),(this.slotOptions||[]).filter(t=>{return~L(t).indexOf(e)})},processOption(e,t){if(!e.componentOptions)return e;const n=e.componentOptions.propsData.value;let o;o=this.multiple?t.includes(n):t===n;const i=j({},e.componentOptions.propsData,{selected:o});return j({},e,{componentOptions:j({},e.componentOptions,{propsData:i})})}}},o,[],!1,null,null,null);M.options.__file="src/components/select/select.vue";var q=M.exports,T=function(){var e=this,t=e.$createElement;return(e._self._c||t)("li",{class:e.classes,on:{click:function(t){return t.stopPropagation(),e.select(t)},mousedown:function(e){e.preventDefault()}}},[e._t("default",[e._v(e._s(e.showLabel))])],2)};T._withStripped=!0;var N=r({name:"MoreOption",mixins:[O],props:{value:{type:[Number,String],required:!0},label:{type:[Number,String]},selected:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},isFoucsed:{type:Boolean}},computed:{classes(){return["".concat("more-select-item"),{["".concat("more-select-item","-selected")]:this.selected,["".concat("more-select-item","-disabled")]:this.disabled}]},showLabel(){return this.label||this.value},optionLabel(){return(this.label||this.$el&&this.$el.textContent).trim()}},methods:{select(){this.disabled||this.dispatch("MoreSelect","on-select-selected",{value:this.value,label:this.optionLabel})}}},T,[],!1,null,null,null);N.options.__file="src/components/select/option.vue";var P=N.exports;n.d(t,"MoreSelect",function(){return q}),n.d(t,"MoreOption",function(){return P}),q.install=function(e){e.component(q.name,q),e.component(P.name,P)};t.default=q}])});